<!DOCTYPE HTML>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="/static/index.css?r={{r}}">
        <script src="/static/js/index.js?r={{r}}"></script>
        <script src="https://kit.fontawesome.com/383a3bf828.js" crossorigin="anonymous"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    </head>
    <body>
        <div style="display:block;">
            <form>
                <label for="username">Name: </label>
                <input type="text" name=”username” id="username">
                <button id="join_leave">Join call</button>
                <button id="share_screen" disabled>Share screen</button>
                <button id="toggle_chat" disabled>Toggle chat</button>
            </form>
            <p id="count">Disconnected.</p>
            <div id="root">
                <div id="container" class="container">
                    <div id="local" class="participant"><div></div><div class="label">Me</div></div>
                </div>
                <div id="chat">
                    <div id="chat-scroll">
                        <div id="chat-content">
                        </div>
                    </div>
                    <input id="chat-input" type="text">
                </div>
            </div>
        </div>


        <div id="friends-list">
            <div id="search-bar">

                <input autocomplete="off" id='search-input' type="search" oninput="search(this.value)" placeholder="Search...">
                <i class="fas fa-bell" onclick="Notis()"></i>
                
            </div>

            <div id="notis" style="display: none;">
                <hr>
                    <h3>Friend Requests</h3>
                 {%for user in data[name]['recived']%}
                    <div class="user">
                        <img draggable="false" class="pfp" src="/{{data[user]['pfp']}}">
                        <span>{{user}}</span>
                        <span onclick="acceptReq('{{user}}');reRender()" id="accept-btn" class="fas fa-user-check userBtns"></span>
                        <span onclick="reject('{{user}}');reRender()" class="fas fa-user-minus userBtns" id="reject-btn"></span>
                    </div>
                 {%endfor%}
                 {%if not data[name]["recived"]%}
                    <h4>No requests.</h4>
                 {%endif%}
                                 <hr id="notis-hr">
            </div>

            <div id="search-res">
               
            </div>
            <hr>
            <div id='friends-div'>
                <h4 style="">Friends</h4>
                {%for friend in friends%}

                    <div class="user">
                        <img draggable="false" class="pfp" src="/{{data[friend]['pfp']}}">
                        <span>{{friend}}</span>
                        <span id="call-btn" class="fas fa-phone-alt userBtns"></span>
                        <span onclick="unfriend('{{friend}}');reRender('{{friend}}')" class="fas fa-user-minus userBtns" id="rm-friend-btn"></span>
                    </div>

                {%endfor%}
                {%if not friends%}
                    <center><h4>No friends online 😢</h4> </center>
                 {%endif%}
                
            </div>
            

        </div>
        <script src="https://media.twiliocdn.com/sdk/js/video/releases/2.3.0/twilio-video.min.js"></script>
        <script src="https://media.twiliocdn.com/sdk/js/conversations/releases/1.0.0/twilio-conversations.min.js"></script>
        <script src="{{ url_for('static', filename='app.js') }}"></script>
    </body>
</html>
